<!DOCTYPE html>
<html lang="en">
<head>

<!-- Prevent redirect loops and send desktop users to desktop version -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const thisIsMobile = window.location.pathname.toLowerCase().includes("calendarmobile.html");
    if (!thisIsMobile && window.innerWidth >= 768) {
      window.location.href = "Calendar.html";
    }
  });
</script>

<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Book a House Tour â€“ Mobile</title>

<style>
  :root {
    --gold: #c6a25a;
    --navy: #0d1b2a;
    --white: #ffffff;
    --soft-bg: #f7f9fc;
  }

  body {
    margin: 0;
    background: var(--white);
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    color: var(--navy);
  }

  /* HEADER */
  .header {
    background-color: var(--navy);
    color: var(--white);
    display: flex;
    justify-content: flex-start;
    align-items: center;
    padding: 12px 16px;
    gap: 20px;
  }

  .logo img {
    height: 50px;
    width: auto;
  }

  /* NAVIGATION */
  .nav ul {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    gap: 16px;
    align-items: center;
    flex-wrap: wrap;
  }

  .nav li { position: relative; }

  .nav a {
    color: var(--white);
    text-decoration: none;
    font-weight: bold;
    font-size: 0.9rem;
    padding: 4px 0;
  }

  .nav a:hover { color: var(--gold); }

  /* DROPDOWN MENU */
  .dropdown-menu {
    display: none;
    flex-direction: column;
    position: absolute;
    left: 0;
    top: 100%;
    background-color: var(--navy);
    min-width: 160px;
    padding: 10px 0;
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    z-index: 999;
  }

  .dropdown-menu a {
    padding: 10px 18px;
    white-space: nowrap;
  }

  /* Show dropdown on tap */
  .dropdown.open .dropdown-menu {
    display: flex;
  }

  /* -------------------------------- */
  /*        CALENDAR SECTION          */
  /* -------------------------------- */

  .calendar-container {
    width: 92%;
    margin: 18px auto 40px;
    background: var(--soft-bg);
    padding: 20px 16px;
    border-radius: 12px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.12);
  }

  .calendar-container h1 {
    font-size: 1.5rem;
    margin-bottom: 12px;
    text-align: center;
    color: var(--navy);
  }

  label {
    font-size: 1rem;
    font-weight: bold;
    display: block;
    margin: 10px 0 6px;
  }

  input[type="date"] {
    width: 100%;
    padding: 12px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 1rem;
  }

  /* TIME SLOTS */
  .time-slots {
    margin-top: 20px;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
  }

  .time-slot {
    padding: 12px;
    text-align: center;
    background: var(--white);
    border-radius: 6px;
    border: 2px solid var(--navy);
    font-weight: bold;
    font-size: 0.95rem;
    cursor: pointer;
    transition: 0.25s;
  }

  .time-slot:hover {
    background: var(--gold);
    border-color: var(--gold);
    color: var(--white);
  }

  .time-slot.selected {
    background: var(--navy);
    color: var(--white);
  }

  /* BOOKING FORM */
  #bookingForm {
    background: var(--white);
    padding: 18px;
    margin-top: 25px;
    border-radius: 10px;
  }

  #bookingForm h2 {
    font-size: 1.3rem;
    text-align: center;
    margin-top: 0;
  }

  input, textarea, button {
    width: 100%;
    padding: 12px;
    margin-top: 10px;
    border-radius: 6px;
    border: 1px solid #bbb;
    font-size: 1rem;
  }

  textarea { min-height: 80px; }

  button {
    background: var(--navy);
    color: var(--white);
    font-weight: bold;
    border: none;
  }

  button:hover {
    background: var(--gold);
    color: var(--navy);
  }

  .hidden { display: none; }

  /* FOOTER */
  .footer {
    background-color: var(--navy);
    color: var(--white);
    padding: 14px;
    text-align: center;
    margin-top: 40px;
    font-size: 0.85rem;
  }
</style>
</head>

<body>

<header class="header">
  <div class="logo">
    <img src="https://raw.githubusercontent.com/michaellouis-cyberbacker/PetersGroup/refs/heads/main/Logos/Peters%20Group.PNG">
  </div>

  <nav class="nav">
    <ul>
      <li><a href="mobile.html#home">Home</a></li>

      <li class="dropdown">
        <a href="javascript:void(0)" class="dropdown-toggle">Rentals</a>
        <div class="dropdown-menu">
          <a href="https://app.rentredi.com/listingDetails/NuczMAXbb3W1sZxAnSCsGehPcXx1" target="_blank">RentRedi</a>
          <a href="https://www.padsplit.com/listing/14427" target="_blank">PadSplit</a>
        </div>
      </li>

      <li><a href="mobile.html#about">About</a></li>
      <li><a href="CalendarMobile.html">House Tours</a></li>

      <li class="dropdown">
        <a href="javascript:void(0)" class="dropdown-toggle">Reviews</a>
        <div class="dropdown-menu">
          <a href="AdamMobile.html">Adam</a>
          <a href="AshleyMobile.html">Ashley</a>
        </div>
      </li>
    </ul>
  </nav>
</header>

<!-- MOBILE CALENDAR AREA -->
<div class="calendar-container">
  <h1>Book a House Tour</h1>

  <label>Select a Date:</label>
  <input type="date" id="datePicker">

  <div id="timeSlots" class="time-slots"></div>

  <div id="bookingForm" class="hidden">
    <h2>Confirm Your Booking</h2>

    <form id="appointmentForm">
      <input id="name" type="text" placeholder="Your Full Name" required>
      <input id="email" type="email" placeholder="Your Email" required>
      <input id="phone" type="tel" placeholder="Phone (Optional)">
      <textarea id="notes" placeholder="Notes (Optional)"></textarea>

      <input type="hidden" id="selectedSlot" name="slot">
      <button type="submit">Confirm Appointment</button>
    </form>
  </div>
</div>

<footer class="footer">
  <p>&copy; 2025 Peters Group Real Estate. All rights reserved.</p>
</footer>

<script>
/* Enable dropdowns on tap */
document.querySelectorAll(".dropdown-toggle").forEach(toggle => {
  toggle.addEventListener("click", function (e) {
    e.preventDefault();
    this.parentElement.classList.toggle("open");
  });
});

/* Calendar Logic (from app.js) */
const startHour = 9;
const endHour = 17;
const interval = 30;
const maxGroupSize = 5;
let bookedSlots = {};

document.addEventListener("DOMContentLoaded", () => {
  const datePicker = document.getElementById("datePicker");
  const timeSlotsDiv = document.getElementById("timeSlots");
  const form = document.getElementById("appointmentForm");
  const formDiv = document.getElementById("bookingForm");
  const selectedSlotInput = document.getElementById("selectedSlot");

  const today = new Date().toISOString().split("T")[0];
  datePicker.min = today;

  datePicker.addEventListener("change", () => {
    renderTimeSlots(datePicker.value);
    formDiv.classList.add("hidden");
  });

  function renderTimeSlots(date) {
    timeSlotsDiv.innerHTML = "";

    for (let hour = startHour; hour < endHour; hour++) {
      for (let min = 0; min < 60; min += interval) {
        const time = `${pad(hour)}:${pad(min)}`;
        const key = `${date}_${time}`;
        const bookedCount = bookedSlots[key] || 0;

        if (bookedCount < maxGroupSize) {
          const slotBtn = document.createElement("div");
          slotBtn.className = "time-slot";
          slotBtn.textContent = time;

          slotBtn.addEventListener("click", () => {
            document.querySelectorAll(".time-slot")
              .forEach(s => s.classList.remove("selected"));

            slotBtn.classList.add("selected");
            selectedSlotInput.value = `${date} ${time}`;
            formDiv.classList.remove("hidden");
          });

          timeSlotsDiv.appendChild(slotBtn);
        }
      }
    }
  }

  form.addEventListener("submit", (e) => {
    e.preventDefault();

    const slot = selectedSlotInput.value;
    bookedSlots[slot.replace(" ", "_")] =
      (bookedSlots[slot.replace(" ", "_")] || 0) + 1;

    alert("Appointment booked for " + slot);

    form.reset();
    formDiv.classList.add("hidden");
    renderTimeSlots(datePicker.value);
  });

  function pad(n) { return n.toString().padStart(2, "0"); }
});
</script>

</body>
</html>